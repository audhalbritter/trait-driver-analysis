---
title: "TDT Paper - Results"
author: "Richard J. Telford"
date: "8/27/2020"
output: pdf_document
classoption: a4paper
bibliography: Rmd/TDT2.bib
csl: Rmd/elsevier-harvard_rjt.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("drake")

```

## Methods

### Software

All analyses were done in R v. `r getRversion()` [@R] and used
traitstrap v. `r packageVersion("traitstrap")` [@traitstrap] to impute traits,
e1071 v. `r packageVersion("e1071")` [@e1071] to calculate moments,
and tidyverse v. `r packageVersion("tidyverse")` [@tidyverse].
Packages drake v. `r packageVersion("drake")` [@drake], 
rmarkdown `r packageVersion("rmarkdown")` [@rmarkdown1] and
renv v. `r packageVersion("renv")` [@renv] were used to ensure reproducibility.
Code to reproduce all the analyses is archived at [https://github.com/richardjtelford/trait-driver-analysis](https://github.com/richardjtelford/trait-driver-analysis).

## Results

**New Figure 2**

```{r trait-climate, eval = TRUE, echo = FALSE, fig.cap="New Fig. 2: Relationship between functional traits and summer air temperature (2m above ground). The trait values are bootstrapped community weighted traits from control plots in 2016. The regression line is shown (grey dashed) and significant relationships are indicated with a solid red line. The shaded area displays the confidence interval. The traits are sorted from positive slope, no significant to negative slope."}
readd(moments_by_climate_plot)
```


**Stats for New Figure 2:** Results from regression between functional traits and summer air temperature.

```{r trait-climate-table, eval = TRUE, echo = FALSE}
readd(moments_by_climate_table)
```


**New Figure 3**

```{r trait_ordination_plot, eval = TRUE, echo = FALSE, fig.cap="New Fig. S2: Multivariate Principal Component Analysis of community trait composition for each of the elevational gradient sites and experimental transplants. "}
readd(ordination_plot)
readd(arrows)
```



**New Figure 4**

```{r conv-div_plot, eval = TRUE, echo = FALSE, fig.height=6, fig.cap="New Fig. 4: Testing for convergence and divergence in each pair-wise trait value as a function of year since transplant. Temporal variation in effect sizes for each measured trait. The first column shows traits divergence and the second column trait convergence. The grey panels labeled with Positive slope, No slope and Negative slopes show the predicted outcome according to TDT, depending on the traits relationship with summer air temperature (see New Fig. 2). The colour of the lines indicates the transplant treatment: transplant to 1.75°C warmer (red), transplant to 0.5°C warmer (pink), OTC (orange), transplant to 0.5°C colder (light blue), transplant to 1.75°C colder (dark blue). Solid lines indicate a significant change in effect size over time."}
readd(conv_div_plot)
```



**New Figure 5**

```{r rda_plot, eval = TRUE, echo = FALSE, fig.cap="Testing for divergence and convergence in multivariate trait-space as a function of year since transplant. Results from  Principal Response Curve multivariate RDA analysis."}
readd(TraitRDA)
```


**New Table 4:** Testing difference in trait composition over time among treatments and the origin control turfs using a permutation test with 999 permutations.

```{r rda_result, eval = TRUE, echo = FALSE}
loadd(rda_warm, rda_cool)

bind_rows(
    warm = rda_warm,
    cool = rda_cool,
    .id = "Treatment"
  )

```



**New Multivariate Figure**

```{r eucledian_plot, eval = TRUE, echo = FALSE, fig.cap="Euclidean distance in functional trait composition since transplant (2012 - 2016) for control plots and treatments at each site. The colours indicate the different treatments control (grey), transplant to 1.75°C warmer (red), transplant to 0.5°C warmer (pink), OTC (orange), transplant to 0.5°C colder (light blue), transplant to 1.75°C colder (dark blue). The two columns show two scenarios of trait plasticity. Divergence reflects a conservative scenario, where treatments are compared to the origin control and do not allow for trait plasticity. Contrary, convergence reflects full plasticity where treatments are compared to the destination controls."}
readd(euclidean_distance_plot)
```


```{r eucledian_table, eval = TRUE, echo = FALSE}
readd(euclidean_dist_table)
```


## Supporting Information

**Stats for New Figure 4:** Results from regression of convergence and divergence in each pair-wise trait value as a function of year since transplant.

```{r conv-div_table, eval = TRUE, echo = FALSE}
readd(treatment_effect_table)
```


**New Figure 6**

```{r variance-plot, eval = TRUE, echo = FALSE, fig.height=8, fig.cap="New Fig. 6: Test of convergence of trait variance to warming and cooling."}
readd(var_plot)
```

**New Figure 7**

```{r skewness-plot, eval = TRUE, echo = FALSE, fig.height=8, fig.cap="New Fig. 7: Test of convergence of trait skewness to warming and cooling."}
readd(skew_plot)
```

**New Figure 8**

```{r kurtosid-plot, eval = TRUE, echo = FALSE, fig.height=8, fig.cap="New Fig. 8: Test of convergence of trait kurtosis to warming and cooling."}
readd(kurt_plot)
```


**Stats for higher moments**

```{r happymoment_table, eval = TRUE, echo = FALSE}
readd(happymoment_effect_table)
```






## References
